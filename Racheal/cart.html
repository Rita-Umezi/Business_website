<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Cart</title>
  <style>
    #cart-items { margin: 8px 0; display:flex; justify-content:space-between; }
    button { padding:5px 8px; }
  </style>
  <link rel="stylesheet" href="cart.css">
  <link rel="icon" href="favicon-32x32.png" type="image/x-icon">
</head>
<body>
  <nav class="navbar">
        <ul class="navhome">
        <a href="Home.html">Home</a>
            <a href="#about_para">About</a>
            <a href="#contact">Contact</a>
            <a href="#option">Products</a>
            <a href="Cart.html">Cart</a>
            <a href="Health page.html">Health Page</a>
            <a href="Cart.html">
            <img class="picture" src="./shopping-cart.png" alt="Shopping Cart" style="height:24px;"></a>   
        </ul>
    </nav>
   
  <h1 style="margin: 50px 0 0 50px; ">Your Cart</h1>
  <div id="cart-items"></div>
  <p style="margin: 100px 0 0 50px; "><strong>Total:</strong> ₦<span id="total">0</span></p>
  <p>
    <button id="clear-cart" >Clear Cart</button>
    <a href="Home.html" id="back">Back to Products</a>
  </p>

  <p style="margin: 50px;">Your items are listed above</p>
  <script>
  document.addEventListener('DOMContentLoaded', () => {
    const itemsDiv = document.getElementById('cart-items');
    const totalEl = document.getElementById('total');
    const clearBtn = document.getElementById('clear-cart');

    function getCart() {
      try { return JSON.parse(localStorage.getItem('cart')) || []; }
      catch (e) { console.warn('Corrupt cart — clearing', e); localStorage.removeItem('cart'); return []; }
    }

    function saveCart(cart) {
      localStorage.setItem('cart', JSON.stringify(cart));
      console.log('cart saved', cart);
    }

    function renderCart() {
      const cart = getCart();
      itemsDiv.innerHTML = '';
      if (cart.length === 0) {
        itemsDiv.innerHTML = '<p style="margin-left: 50px;">Your cart is empty.</p>';
        totalEl.textContent = '0';
        return;
      }
      let total = 0;
      cart.forEach((item, idx) => {
        total += item.price;
        const row = document.createElement('div');
        row.className = 'cart-item';
        row.innerHTML = `<span>${item.product} - ₦${item.price}</span>
                         <button class="remove" data-index="${idx}" style:>Remove</button>`;
        itemsDiv.appendChild(row);
      });
      totalEl.textContent = total;
    }

    // Event delegation for remove buttons
    itemsDiv.addEventListener('click', (e) => {
      if (!e.target.matches('.remove')) return;
      const idx = Number(e.target.dataset.index);
      const cart = getCart();
      cart.splice(idx, 1);
      saveCart(cart);
      renderCart();
    });

    clearBtn.addEventListener('click', () => {
      localStorage.removeItem('cart');
      renderCart();
      console.log('cart cleared');
    });

    renderCart();
  });
  </script>
</body>
</html>