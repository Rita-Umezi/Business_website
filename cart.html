<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Cart | Ray's Kitchen</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&family=Playfair+Display:ital,wght@0,700;1,700&display=swap" rel="stylesheet">
    <script src="https://kit.fontawesome.com/25c990c666.js" crossorigin="anonymous"></script>
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; }
        .serif { font-family: 'Playfair Display', serif; }
        .glass { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 min-h-screen flex flex-col">

    <nav class="fixed w-full z-50 glass border-b border-orange-100">
        <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
            <div class="serif text-2xl font-bold text-orange-600">Ray's Kitchen</div>
            <ul class="hidden md:flex space-x-8 font-semibold text-sm uppercase tracking-widest">
                <li><a href="index.html" class="hover:text-orange-500 transition">Home</a></li>
                <li><a href="index.html#option" class="hover:text-orange-500 transition">Menu</a></li>
                <li><a href="Health page.html" class="hover:text-orange-500 transition">Health</a></li>
                <li><a href="cart.html" class="text-orange-600"><i class="fa-solid fa-cart-shopping"></i></a></li>
            </ul>
        </div>
    </nav>

    <main class="flex-grow pt-32 pb-20 px-6">
        <div class="max-w-4xl mx-auto">
            <div class="flex flex-col md:flex-row justify-between items-end mb-10 gap-4">
                <div>
                    <h1 class="serif text-5xl mb-2">Shopping Cart</h1>
                    <p class="text-slate-500">Review your wholesome selection before checkout.</p>
                </div>
                <button id="clear-cart" class="text-red-500 hover:text-red-700 text-sm font-bold flex items-center gap-2 transition">
                    <i class="fa-solid fa-trash-can"></i> Clear All
                </button>
            </div>

            <div id="cart-items" class="bg-white rounded-[2rem] shadow-xl shadow-orange-900/5 overflow-hidden p-8 mb-8 space-y-6">
                </div>

            <div class="bg-white rounded-3xl shadow-lg p-8">
                <div class="flex justify-between items-center mb-6">
                    <span class="text-xl font-bold">Total Amount:</span>
                    <span class="text-3xl font-black text-orange-600 italic">₦<span id="total">0</span></span>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <a href="index.html" class="flex items-center justify-center gap-2 border-2 border-slate-200 py-4 rounded-full font-bold hover:bg-slate-50 transition">
                        <i class="fa-solid fa-arrow-left"></i> Continue Shopping
                    </a>
                    <button id="payButton" class="bg-orange-600 text-white py-4 rounded-full font-bold shadow-lg shadow-orange-600/30 hover:bg-orange-700 transition flex items-center justify-center gap-3">
                        Secure Checkout <i class="fa-solid fa-lock"></i>
                    </button>
                </div>
            </div>
        </div>
    </main>

    <footer class="bg-slate-900 text-white/50 py-8 text-center text-xs tracking-widest">
        &copy; 2026 Ray's Kitchen Ltd. All rights reserved.
    </footer>

    <script>
        // IMAGE MAPPING: Link product IDs to your actual filenames
        const productImages = {
            'Parfait_large': 'Parfait2.png',
            'Parfait_medium': 'Parfait2.png',
            'Parfait_small': 'Parfait2.png',
            'Chicken_salad': 'chicken salad.jpg',
            'Banana_bread_with_dark_chocolate_toppings': 'banana bread2.jpg',
            'Pineapple_juice': 'pineapple.png',
            // Add other product IDs here...
        };

        document.addEventListener('DOMContentLoaded', () => {
            const itemsDiv = document.getElementById('cart-items');
            const totalEl = document.getElementById('total');
            const clearBtn = document.getElementById('clear-cart');
            const payButton = document.getElementById('payButton');

            function getCart() {
                try { return JSON.parse(localStorage.getItem('cart')) || []; }
                catch (e) { localStorage.removeItem('cart'); return []; }
            }

            function saveCart(cart) {
                localStorage.setItem('cart', JSON.stringify(cart));
            }

            function renderCart() {
                const cart = getCart();
                itemsDiv.innerHTML = '';

                if (cart.length === 0) {
                    itemsDiv.innerHTML = `
                        <div class="text-center py-12">
                            <i class="fa-solid fa-basket-shopping text-6xl text-slate-200 mb-4 block"></i>
                            <p class="text-slate-400 font-bold">Your cart is currently empty.</p>
                        </div>`;
                    totalEl.textContent = '0';
                    return;
                }

                // GROUPING LOGIC: Count quantities of same items
                const groupedCart = cart.reduce((acc, item) => {
                    const key = item.product;
                    if (!acc[key]) {
                        acc[key] = { ...item, quantity: 1 };
                    } else {
                        acc[key].quantity += 1;
                    }
                    return acc;
                }, {});

                let total = 0;

                Object.values(groupedCart).forEach((item) => {
                    const subtotal = item.price * item.quantity;
                    total += subtotal;
                    
                    // Fallback to a placeholder if image is missing
                    const imgPath = productImages[item.product] || 'placeholder.png';

                    const row = document.createElement('div');
                    row.className = 'flex items-center gap-4 md:gap-8 pb-6 border-b border-slate-100 last:border-0 last:pb-0';
                    row.innerHTML = `
                        <img src="${imgPath}" class="w-20 h-20 md:w-24 md:h-24 object-cover rounded-2xl shadow-sm" alt="${item.product}">
                        <div class="flex-grow">
                            <h3 class="font-bold text-lg leading-tight capitalize">${item.product.replace(/_/g, ' ')}</h3>
                            <p class="text-orange-600 font-bold">₦${item.price.toLocaleString()}</p>
                            <div class="mt-2 text-xs text-slate-400 font-bold uppercase tracking-widest">Qty: ${item.quantity}</div>
                        </div>
                        <div class="text-right flex flex-col items-end gap-2">
                            <span class="font-black text-slate-800">₦${subtotal.toLocaleString()}</span>
                            <button class="remove text-xs text-red-400 hover:text-red-600 font-bold transition uppercase tracking-tighter" data-name="${item.product}">
                                <i class="fa-solid fa-xmark"></i> Remove
                            </button>
                        </div>`;
                    itemsDiv.appendChild(row);
                });

                totalEl.textContent = total.toLocaleString();
            }

            // REMOVE ITEM BY NAME (to handle grouped items properly)
            itemsDiv.addEventListener('click', (e) => {
                const removeBtn = e.target.closest('.remove');
                if (!removeBtn) return;
                
                const productName = removeBtn.dataset.name;
                let cart = getCart();
                
                // Find index of first match and remove it
                const index = cart.findIndex(item => item.product === productName);
                if (index > -1) {
                    cart.splice(index, 1);
                    saveCart(cart);
                    renderCart();
                }
            });

            clearBtn.addEventListener('click', () => {
                if(confirm("Are you sure you want to clear your cart?")) {
                    localStorage.removeItem('cart');
                    renderCart();
                }
            });

            payButton.addEventListener('click', () => {
                if(getCart().length === 0) return alert("Your cart is empty!");
                window.location.href = 'https://paystack.shop/pay/wxbik4d-ad';
            });

            renderCart();
        });
    </script>
</body>
</html>